!function(a,b){a.ui.navigator.register(function(){return{pluginName:"iscroll",_init:function(){return this._adjustHtml()._reBindEvent()._initOrg()},_reBindEvent:function(){var c=this,d=c._data;return d.isScrollToNext=d.isScrollToNext===b?!0:d.isScrollToNext,d.isShowShadow=d.isShowShadow===b?!0:d.isShowShadow,c._loadIscroll(),a(window).on("ortchange",a.proxy(c._ortChangeHandler,c)),c.on("destroy",function(){a(window).off("ortchange",c._ortChangeHandler),d.iScroll.destroy()}),c},_adjustHtml:function(){var b=this,c=b._data,d=b.root().addClass("ui-navigator"),e=d.find("ul"),f=d.find(".ui-navigator-wrapper"),g=e.find("li"),h=[0];return!f.length&&e.wrap('<div class="ui-navigator-wrapper"></div>'),e.find("li").each(function(a){h[a]=a?h[a-1]+this.offsetWidth:h[a]+this.offsetLeft-e[0].offsetLeft+this.offsetWidth}),a.extend(c,{_$navWrapper:d.find(".ui-navigator-wrapper"),_$navScroller:e.width(h[g.length-1]+1),_$navList:g,_scrollerNum:g.length,_scrollerSumWidth:h,_$fixElemLeft:d.find(".ui-navigator-fixleft"),_$fixElemRight:d.find(".ui-navigator-fixright")}),b},_loadIscroll:function(){var b=this,c=b._data;return c.iScroll=iScroll(c._$navWrapper.get(0),c.iScrollOpts=a.extend({hScroll:!0,vScroll:!1,hScrollbar:!1,vScrollbar:!1},c.iScrollOpts,{onScrollStart:function(a){b.trigger("scrollstart",a)},onScrollMove:function(a){b.trigger("scrollmove",a)},onScrollEnd:function(a){c.isShowShadow&&b._setShadow(),b.trigger("scrollend",a)}})),b},_setShadow:function(){var a=this,b=a._data,c=b._$navWrapper,d={left:"ui-navigator-shadowl",right:"ui-navigator-shadowr",all:"ui-navigator-shadowall"},e=b.iScroll,f=e.x;return 0>f?(c.removeClass(d.left+" "+d.right).addClass(d.all),f<=e.maxScrollX&&c.removeClass(d.all+" "+d.right).addClass(d.left)):(c.removeClass(d.all+" "+d.left),e.hScroll?c.addClass(d.right):c.removeClass(d.all+" "+d.left+" "+d.right)),a},_scrollToNext:function(a,b){var c=this,d=c._data,e=d._scrollerSumWidth,f=d.iScroll;return f.scrollTo("last"==b?f.wrapperW-(e[a+1]||e[e.length-1]):"first"==b?-e[a-2]||0:f.x,0,400),c},_getPos:function(a){var b=this,c=b._data,d=c.iScroll,e=Math.abs(d.x)||0,f=c._scrollerSumWidth,g=c._$navList,h=f[a]-e,i=f[a-1||0]-e,j=(f[a+1]||f[f.length-1])-e,k=d.wrapperW;return h>=k||j>k?"last":h<=g[a].offsetWidth||i<g[a-1].offsetWidth?"first":"middle"},_ortChangeHandler:function(){var a=this,b=a._data,c=b.iScroll;c.refresh(),a._setShadow(),b._$navWrapper.width(c.wrapperW-c.wrapperOffsetLeft)},switchTo:function(a,b,c){var d=this,e=d._data;if(d.switchToOrg(a,b,c),!e._$tabList.eq(a).hasClass("ui-navigator-fix")){var f=e._$fixElemLeft,a=a-(f.length?f.length:0),g=d._getPos(a);b&&e.isShowShadow&&d._setShadow(),e.isScrollToNext&&d._scrollToNext(a,g)}return d}}})}(Zepto);